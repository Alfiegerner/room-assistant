<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Monitoring | room-assistant</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#2d89ef">
    <meta name="description" content="A companion software to bring your home automation to the room-level for presence detection and more.">
    <meta property="article:modified_time" content="2021-05-24T20:42:36.000Z">
    <meta property="og:site_name" content="room-assistant">
    <meta property="og:title" content="Monitoring">
    <meta property="og:type" content="website">
    <meta property="og:url" content="www.room-assistant.io/guide/monitoring.html">
    <meta name="twitter:title" content="Monitoring">
    <meta name="twitter:url" content="www.room-assistant.io/guide/monitoring.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:data1" content="Heiko Rothe">
    <meta name="twitter:creator" content="@mKeRix">
    <meta name="msapplication-TileColor" content="#2d89ef">
    <meta name="theme-color" content="#ffffff">
    
    <link rel="preload" href="/assets/css/0.styles.45b58280.css" as="style"><link rel="preload" href="/assets/js/app.0db8b717.js" as="script"><link rel="preload" href="/assets/js/3.f3a37c3c.js" as="script"><link rel="preload" href="/assets/js/21.8d88adf1.js" as="script"><link rel="preload" href="/assets/js/4.d205f08f.js" as="script"><link rel="prefetch" href="/assets/js/10.3e3169c1.js"><link rel="prefetch" href="/assets/js/11.f3b7acbf.js"><link rel="prefetch" href="/assets/js/12.cc13ae2d.js"><link rel="prefetch" href="/assets/js/13.0e07294e.js"><link rel="prefetch" href="/assets/js/14.75d48d16.js"><link rel="prefetch" href="/assets/js/15.63f1336b.js"><link rel="prefetch" href="/assets/js/16.efc9de3a.js"><link rel="prefetch" href="/assets/js/17.b1fe6080.js"><link rel="prefetch" href="/assets/js/18.df4402f5.js"><link rel="prefetch" href="/assets/js/19.acc44dea.js"><link rel="prefetch" href="/assets/js/20.54d55eb5.js"><link rel="prefetch" href="/assets/js/22.9a0dac00.js"><link rel="prefetch" href="/assets/js/23.1bcb55c2.js"><link rel="prefetch" href="/assets/js/24.078980d4.js"><link rel="prefetch" href="/assets/js/25.e9a07193.js"><link rel="prefetch" href="/assets/js/26.c0337e5c.js"><link rel="prefetch" href="/assets/js/27.0214163c.js"><link rel="prefetch" href="/assets/js/28.e9682dc4.js"><link rel="prefetch" href="/assets/js/29.9911689c.js"><link rel="prefetch" href="/assets/js/30.0ca36a22.js"><link rel="prefetch" href="/assets/js/31.ba86d775.js"><link rel="prefetch" href="/assets/js/32.6fd3dc4c.js"><link rel="prefetch" href="/assets/js/33.4b66aca6.js"><link rel="prefetch" href="/assets/js/34.96165e5e.js"><link rel="prefetch" href="/assets/js/5.c6425b1f.js"><link rel="prefetch" href="/assets/js/6.243cd464.js"><link rel="prefetch" href="/assets/js/7.2ad04b01.js"><link rel="prefetch" href="/assets/js/8.af9600e6.js"><link rel="prefetch" href="/assets/js/9.a0fad002.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.883d461f.js">
    <link rel="stylesheet" href="/assets/css/0.styles.45b58280.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">room-assistant</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"><div class="nav-item"><a href="/guide/" class="nav-link router-link-active">
  Guide
</a></div><div class="nav-item"><a href="/integrations/" class="nav-link">
  Integrations
</a></div><div class="nav-item"><a href="https://github.com/mKeRix/room-assistant/discussions" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Forum
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/mKeRix/room-assistant?sponsor=1" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Sponsor
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/mKeRix/room-assistant" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/guide/" class="nav-link router-link-active">
  Guide
</a></div><div class="nav-item"><a href="/integrations/" class="nav-link">
  Integrations
</a></div><div class="nav-item"><a href="https://github.com/mKeRix/room-assistant/discussions" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Forum
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/mKeRix/room-assistant?sponsor=1" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Sponsor
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/mKeRix/room-assistant" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Guide</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide/" aria-current="page" class="sidebar-link">Introduction</a></li><li><a href="/guide/installation.html" class="sidebar-link">Installation</a></li><li><a href="/guide/upgrading.html" class="sidebar-link">Upgrading</a></li><li><a href="/guide/configuration.html" class="sidebar-link">Configuration</a></li><li><a href="/guide/cluster.html" class="sidebar-link">Cluster</a></li><li><a href="/guide/entities.html" class="sidebar-link">Entities</a></li><li><a href="/guide/monitoring.html" aria-current="page" class="active sidebar-link">Monitoring</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guide/monitoring.html#metrics" class="sidebar-link">Metrics</a></li><li class="sidebar-sub-header"><a href="/guide/monitoring.html#logging" class="sidebar-link">Logging</a></li></ul></li><li><a href="/guide/cli.html" class="sidebar-link">CLI</a></li><li><a href="/guide/api.html" class="sidebar-link">API</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Quickstart</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide/quickstart-pi-zero-w.html" class="sidebar-link">Raspberry Pi Zero W</a></li><li><a href="/guide/quickstart-pi.html" class="sidebar-link">Raspberry Pi 3 or 4</a></li><li><a href="/guide/quickstart-ansible.html" class="sidebar-link">Ansible</a></li><li><a href="/guide/quickstart-docker.html" class="sidebar-link">Docker</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="monitoring"><a href="#monitoring" class="header-anchor">#</a> Monitoring</h1> <p>Since room-assistant is a distributed system it quickly gets difficult to keep track of everything. To help we provide some tools for power users that wish to keep track of all their instance states without having to go to each one manually.</p> <h2 id="metrics"><a href="#metrics" class="header-anchor">#</a> Metrics</h2> <p>room-assistant provides metrics in the Prometheus format on port <code>6415</code>, path <code>/metrics</code>. This includes some default metrics about the general state of the application, as well as integration-specific metrics that you can explore. You can setup your Prometheus instance to scrape these endpoints like this:</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">scrape_configs</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">job_name</span><span class="token punctuation">:</span> <span class="token string">'room-assistant'</span>
    <span class="token key atrule">metrics_path</span><span class="token punctuation">:</span> <span class="token string">'/metrics'</span>
    <span class="token key atrule">scrape_interval</span><span class="token punctuation">:</span> 30s
    <span class="token key atrule">static_configs</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">targets</span><span class="token punctuation">:</span>
      		<span class="token punctuation">-</span> <span class="token string">'&lt;room-assistant-ip1&gt;:6415'</span>
      		<span class="token punctuation">-</span> <span class="token string">'&lt;room-assistant-ip2&gt;:6415'</span>
</code></pre></div><h2 id="logging"><a href="#logging" class="header-anchor">#</a> Logging</h2> <p><strong>Config Key:</strong> <code>logger</code></p> <p>If you want to capture the logs of all your instances in a single place you can configure additional log outputs, which will be used alongside the console output you are used to.</p> <h3 id="elasticsearch-kibana"><a href="#elasticsearch-kibana" class="header-anchor">#</a> Elasticsearch/Kibana</h3> <p><strong>Config Key:</strong> <code>elasticsearch</code></p> <p>room-assistant is capable of piping log output into an Elasticsearch cluster with the logstash format, which makes it searchable from Kibana. On NodeJS installations this logger requires an additional dependency, which you can install with <code>npm install -g winston-elasticsearch</code>.</p> <table><thead><tr><th>Name</th> <th>Type</th> <th>Default</th> <th>Description</th></tr></thead> <tbody><tr><td><code>enabled</code></td> <td>Boolean</td> <td><code>false</code></td> <td>Whether room-assistant should send logs to Elasticsearch or not.</td></tr> <tr><td><code>node</code></td> <td>String</td> <td>http://localhost:9200</td> <td>The endpoint under which your Elasticsearch cluster is accessible.</td></tr> <tr><td><code>auth</code></td> <td>Object</td> <td></td> <td>Object containing either <code>username</code> + <code>password</code> or <code>apiKey</code> that should be used for authenticating against your Elasticsearch cluster (matches <code>auth</code> in the <a href="https://www.elastic.co/guide/en/elasticsearch/client/javascript-api/current/client-configuration.html" target="_blank" rel="noopener noreferrer">official client docs<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>).</td></tr> <tr><td><code>indexPrefix</code></td> <td>String</td> <td><code>room-assistant</code></td> <td>The prefix of the indices that will be created. The indices follow the naming format <code>&lt;indexPrefix&gt;-&lt;date&gt;</code>.</td></tr></tbody></table> <details class="custom-block details"><summary>Example Config</summary> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">logger</span><span class="token punctuation">:</span>
  <span class="token key atrule">elasticsearch</span><span class="token punctuation">:</span>
    <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">node</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//192.168.0.20<span class="token punctuation">:</span><span class="token number">9200</span>
</code></pre></div></details> <h3 id="loki"><a href="#loki" class="header-anchor">#</a> Loki</h3> <p><strong>Config Key:</strong> <code>loki</code></p> <p>You can send the room-assistant logs to an instance of <a href="https://grafana.com/oss/loki/" target="_blank" rel="noopener noreferrer">Grafana Loki<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, which will allow you to collect and query logs easily from <a href="https://grafana.com/grafana/" target="_blank" rel="noopener noreferrer">Grafana<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. On NodeJS installations this logger requires an additional dependency, which you can install with <code>npm install -g winston-loki</code>.</p> <table><thead><tr><th>Name</th> <th>Type</th> <th>Default</th> <th>Description</th></tr></thead> <tbody><tr><td><code>enabled</code></td> <td>Boolean</td> <td><code>false</code></td> <td>Whether room-assistant should send logs to Loki or not.</td></tr> <tr><td><code>host</code></td> <td>String</td> <td>http://localhost:3100</td> <td>The endpoint of your Loki instance.</td></tr></tbody></table> <details class="custom-block details"><summary>Example Config</summary> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">logger</span><span class="token punctuation">:</span>
  <span class="token key atrule">loki</span><span class="token punctuation">:</span>
    <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">host</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//192.168.0.20<span class="token punctuation">:</span><span class="token number">3100</span>
</code></pre></div></details></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/mKeRix/room-assistant/edit/main/docs/guide/monitoring.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">5/24/2021, 8:42:36 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/guide/entities.html" class="prev">
        Entities
      </a></span> <span class="next"><a href="/guide/cli.html">
        CLI
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.0db8b717.js" defer></script><script src="/assets/js/3.f3a37c3c.js" defer></script><script src="/assets/js/21.8d88adf1.js" defer></script><script src="/assets/js/4.d205f08f.js" defer></script>
  </body>
</html>
